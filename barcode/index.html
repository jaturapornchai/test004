<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Generator - Clean B&W</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff8c42 0%, #ff6b35 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: #ffffff;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
            max-width: 500px;
            width: 100%;
            border: 2px solid #ff8c42;
        }
        
        h1 {
            text-align: center;
            color: #ff6b35;
            margin-bottom: 30px;
            font-size: 2em;
            font-weight: 700;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #ff6b35;
            font-weight: 600;
            font-size: 0.95em;
        }
        
        input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #ffe4d6;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fffaf7;
            color: #000000;
        }
        
        input::placeholder {
            color: #ffb399;
        }
        
        input:focus {
            outline: none;
            border-color: #ff8c42;
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(255, 140, 66, 0.1);
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }
        
        button {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #ffffff;
        }
        
        button:active:not(:disabled) {
            transform: translateY(1px);
        }
        
        button:disabled {
            background: #e0e0e0;
            color: #999999;
            cursor: not-allowed;
        }
        
        .btn-generate {
            background: linear-gradient(135deg, #ff6b35 0%, #ff8c42 100%);
        }
        
        .btn-generate:hover {
            background: linear-gradient(135deg, #ff8c42 0%, #ff6b35 100%);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        button:not(.btn-generate):not(:disabled) {
            background: #ff8c42;
        }
        
        button:not(.btn-generate):not(:disabled):hover {
            background: #ff6b35;
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        .preview-container {
            margin-top: 30px;
            text-align: center;
            padding: 20px;
            background: #fff8f5;
            border: 2px solid #ffe4d6;
            border-radius: 8px;
            min-height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #preview {
            max-width: 100%;
            border: 1px solid #e0e0e0;
            background: #ffffff;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        #placeholder {
            color: #ff8c42;
            font-size: 1em;
            font-weight: 500;
        }
        
        #hiddenCanvas, #barcodeCanvas {
            display: none;
        }
        
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ff8c42;
            color: #ffffff;
            padding: 15px 25px;
            border-radius: 6px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1000;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }
        
        .success-message.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .success-message.error {
            background: #ff4444;
        }
        
        .barcode-type {
            color: #ff8c42;
            font-size: 12px;
            margin-top: 5px;
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 25px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            .button-group {
                flex-direction: column;
            }
        }
        
        .icon-btn:hover {
            background: #ff6b35 !important;
            box-shadow: 0 3px 10px rgba(255, 107, 53, 0.3);
        }
        
        .icon-btn:hover svg {
            transform: rotate(180deg);
        }
        
        .icon-btn:active {
            transform: translateY(1px);
        }
        
        .icon-btn svg {
            transition: transform 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üü† Barcode Generator</h1>
        
        <div class="form-group">
            <label for="barcode">‡∏£‡∏´‡∏±‡∏™ Barcode</label>
            <div style="display: flex; gap: 6px; align-items: center;">
                <input type="text" id="barcode" placeholder="‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™" autocomplete="off" style="flex: 1; height: 34px; padding: 8px 12px; border-radius: 4px;">
                <button onclick="generateRandomBarcode()" class="icon-btn" style="width: 34px; height: 34px; padding: 0; border-radius: 4px; background: #ff8c42; border: none; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; flex-shrink: 0;" title="‡∏™‡∏£‡πâ‡∏≤‡∏á Barcode ‡πÉ‡∏´‡∏°‡πà">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="23 4 23 10 17 10"></polyline>
                        <polyline points="1 20 1 14 7 14"></polyline>
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                    </svg>
                </button>
            </div>
            <small style="color: #ff8c42; font-size: 12px; margin-top: 5px; display: block;">* ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏£‡∏´‡∏±‡∏™ EAN-13</small>
            <div id="barcode-type" class="barcode-type"></div>
        </div>
        
        <div class="form-group">
            <label for="name">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á</label>
            <input type="text" id="name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)" autocomplete="off">
        </div>
        
        <div class="form-group">
            <label for="code">‡∏£‡∏´‡∏±‡∏™</label>
            <input type="text" id="code" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)" autocomplete="off">
        </div>
        
        <div class="form-group">
            <label for="amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</label>
            <input type="number" id="amount" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)" step="0.01" autocomplete="off">
        </div>
        
        <div class="preview-container">
            <img id="preview" style="display: none;" alt="Barcode Preview">
            <div id="placeholder">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á Barcode</div>
        </div>
        
        <div class="button-group">
            <button onclick="downloadImage()" disabled>Download PNG</button>
            <button onclick="copyToClipboard()" disabled>Copy Image</button>
        </div>
    </div>
    
    <canvas id="hiddenCanvas"></canvas>
    <canvas id="barcodeCanvas"></canvas>
    
    <div class="success-message" id="successMessage"></div>
    
    <script>
        let currentImageData = null;
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á barcode ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢
        function detectBarcodeType(barcode) {
            // ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
            barcode = barcode.replace(/\s/g, '');
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏•‡πâ‡∏ß‡∏ô
            if (/^\d+$/.test(barcode)) {
                if (barcode.length === 13) return 'EAN13';
                if (barcode.length === 8) return 'EAN8';
                if (barcode.length === 12) return 'UPC';
                if (barcode.length === 14) return 'ITF14';
            }
            
            // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡πÉ‡∏ä‡πâ CODE128
            return 'CODE128';
        }
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á barcode
        function displayBarcodeType(type) {
            const typeDisplay = document.getElementById('barcode-type');
            const typeNames = {
                'EAN13': 'EAN-13 (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)',
                'EAN8': 'EAN-8 (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å)',
                'UPC': 'UPC-A (‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤)',
                'ITF14': 'ITF-14 (‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤)',
                'CODE128': 'Code 128 (‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)'
            };
            
            typeDisplay.textContent = `‡∏ä‡∏ô‡∏¥‡∏î: ${typeNames[type] || type}`;
        }
        
        function generateRandomBarcodeOnly() {
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á barcode ‡πÅ‡∏ö‡∏ö EAN-13 (13 ‡∏´‡∏•‡∏±‡∏Å)
            let barcode = '';
            for (let i = 0; i < 12; i++) {
                barcode += Math.floor(Math.random() * 10);
            }
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì check digit ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö EAN-13
            let sum = 0;
            for (let i = 0; i < 12; i++) {
                if (i % 2 === 0) {
                    sum += parseInt(barcode[i]);
                } else {
                    sum += parseInt(barcode[i]) * 3;
                }
            }
            let checkDigit = (10 - (sum % 10)) % 10;
            barcode += checkDigit;
            
            document.getElementById('barcode').value = barcode;
            displayBarcodeType('EAN13');
        }
        
        function generateRandomBarcode() {
            generateRandomBarcodeOnly();
            createBarcode();
            showMessage('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™ Barcode ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡πâ‡∏ß!', 'success');
        }
        
        function createBarcode() {
            const name = document.getElementById('name').value;
            const code = document.getElementById('code').value;
            const amount = document.getElementById('amount').value;
            let barcodeValue = document.getElementById('barcode').value;
            
            // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ barcode
            if (!barcodeValue) {
                showMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏™‡∏£‡πâ‡∏≤‡∏á Barcode ‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™', 'error');
                return;
            }
            
            // ‡∏•‡∏ö‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á
            barcodeValue = barcodeValue.trim();
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á barcode
            const barcodeType = detectBarcodeType(barcodeValue);
            displayBarcodeType(barcodeType);
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á barcode ‡∏ö‡∏ô canvas ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
            const barcodeCanvas = document.getElementById('barcodeCanvas');
            
            try {
                // ‡∏•‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡∏ô‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö
                let options = {
                    format: barcodeType,
                    width: 2,
                    height: 70,
                    displayValue: true,
                    fontSize: 14,
                    margin: 10,
                    background: "#ffffff",
                    lineColor: "#000000",
                    valid: function(valid) {
                        if (!valid) {
                            console.log("Barcode validation failed");
                        }
                    }
                };
                
                JsBarcode(barcodeCanvas, barcodeValue, options);
                
            } catch (error) {
                // ‡∏ñ‡πâ‡∏≤ error ‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ CODE128 ‡πÅ‡∏ó‡∏ô
                try {
                    JsBarcode(barcodeCanvas, barcodeValue, {
                        format: "CODE128",
                        width: 2,
                        height: 70,
                        displayValue: true,
                        fontSize: 14,
                        margin: 10,
                        background: "#ffffff",
                        lineColor: "#000000"
                    });
                    displayBarcodeType('CODE128');
                } catch (error2) {
                    showMessage('‡∏£‡∏´‡∏±‡∏™ Barcode ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
                    console.error('Barcode generation error:', error2);
                    return;
                }
            }
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á canvas ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á
            const canvas = document.getElementById('hiddenCanvas');
            const ctx = canvas.getContext('2d');
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á canvas ‡∏ï‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
            const hasName = name && name.trim() !== '';
            const hasAmount = amount && parseFloat(amount) > 0;
            const hasCode = code && code.trim() !== '';
            
            let canvasHeight = 150; // base height ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö barcode ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
            if (hasName) canvasHeight += 35;
            if (hasAmount) canvasHeight += 40;
            if (hasCode) canvasHeight += 30;
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î canvas
            canvas.width = 400;
            canvas.height = canvasHeight;
            
            // ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å‡∏™‡∏µ‡∏î‡∏≥
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
            ctx.strokeRect(1, 1, canvas.width - 2, canvas.height - 2);
            
            let yPosition = 30;
            
            // 1. ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤/‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á (‡∏ö‡∏ô‡∏™‡∏∏‡∏î) - ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ
            if (hasName) {
                ctx.fillStyle = '#000000';
                ctx.font = 'bold 18px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(name, canvas.width / 2, yPosition);
                yPosition += 20;
            }
            
            // 2. BARCODE
            ctx.drawImage(barcodeCanvas, (canvas.width - barcodeCanvas.width) / 2, yPosition);
            yPosition += barcodeCanvas.height + 30; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 15 ‡πÄ‡∏õ‡πá‡∏ô 30
            
            // 3. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡πÅ‡∏•‡∏∞‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0)
            if (hasAmount) {
                ctx.font = 'bold 36px Arial'; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å 32px ‡πÄ‡∏õ‡πá‡∏ô 36px
                ctx.fillStyle = '#000000';
                const formattedAmount = parseFloat(amount).toLocaleString('th-TH', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                ctx.fillText('‡∏ø' + formattedAmount, canvas.width / 2, yPosition);
                yPosition += 35; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 30 ‡πÄ‡∏õ‡πá‡∏ô 35
            }
            
            // 4. ‡∏£‡∏´‡∏±‡∏™ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
            if (hasCode) {
                ctx.font = '14px Arial';
                ctx.fillStyle = '#000000';
                ctx.textAlign = 'center';
                ctx.fillText('‡∏£‡∏´‡∏±‡∏™: ' + code, canvas.width / 2, yPosition);
            }
            
            // ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô image
            currentImageData = canvas.toDataURL('image/png');
            const preview = document.getElementById('preview');
            preview.src = currentImageData;
            preview.style.display = 'block';
            document.getElementById('placeholder').style.display = 'none';
            
            // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏õ‡∏∏‡πà‡∏°
            document.querySelectorAll('button[disabled]').forEach(btn => {
                btn.disabled = false;
            });
            
            showMessage('‡∏™‡∏£‡πâ‡∏≤‡∏á Barcode ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
        }
        
        function downloadImage() {
            if (!currentImageData) {
                showMessage('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î', 'error');
                return;
            }
            
            try {
                const link = document.createElement('a');
                const timestamp = new Date().getTime();
                link.download = `barcode_${timestamp}.png`;
                link.href = currentImageData;
                link.click();
                
                showMessage('‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
            } catch (error) {
                showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î', 'error');
                console.error('Download error:', error);
            }
        }
        
        async function copyToClipboard() {
            if (!currentImageData) return;
            
            try {
                const blob = await (await fetch(currentImageData)).blob();
                const item = new ClipboardItem({ 'image/png': blob });
                await navigator.clipboard.write([item]);
                showMessage('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
            } catch (err) {
                console.error('Error copying image:', err);
                showMessage('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏î‡πâ', 'error');
            }
        }
        
        function showMessage(text, type) {
            const messageEl = document.getElementById('successMessage');
            messageEl.textContent = text;
            messageEl.className = 'success-message';
            if (type === 'error') {
                messageEl.classList.add('error');
            }
            messageEl.classList.add('show');
            
            setTimeout(() => {
                messageEl.classList.remove('show');
            }, 3000);
        }
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö real-time
        let debounceTimer;
        document.querySelectorAll('input').forEach(input => {
            // ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ü‡∏±‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡∏≠‡∏á barcode input
            if (input.id === 'barcode') return;
            
            input.addEventListener('input', () => {
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    const barcodeValue = document.getElementById('barcode').value;
                    
                    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ barcode ‡πÅ‡∏•‡πâ‡∏ß
                    if (barcodeValue) {
                        createBarcode();
                    }
                }, 500); // ‡∏£‡∏≠ 500ms ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏¢‡∏∏‡∏î‡∏û‡∏¥‡∏°‡∏û‡πå
            });
        });
        
        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö barcode input ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏ô‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        document.getElementById('barcode').addEventListener('input', (e) => {
            const barcodeValue = e.target.value;
            
            if (barcodeValue) {
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á barcode ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                const type = detectBarcodeType(barcodeValue);
                displayBarcodeType(type);
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á barcode
                clearTimeout(debounceTimer);
                debounceTimer = setTimeout(() => {
                    createBarcode();
                }, 500);
            } else {
                document.getElementById('barcode-type').textContent = '';
            }
        });
        
        // Enter key support
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    createBarcode();
                }
            });
        });
    </script>
</body>
</html>